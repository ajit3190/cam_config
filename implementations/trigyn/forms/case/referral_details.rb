# frozen_string_literal: true

referral_details_fields = [
  Field.new('name' => 'case_id_display',
            'type' => 'text_field',
            'editable' => false,
            'disabled' => true,
            'display_name_en' => 'Case ID'),
  Field.new('name' => 'name',
            'type' => 'text_field',
            'display_name_en' => 'Full Name',
            'required' => false,
            'show_on_minify_form' => true,
            'hidden_text_field' => true,
            'matchable' => true,
            'disabled' => true),
  Field.new('name' => 'name_nickname',
            'type' => 'text_field',
            'display_name_en' => 'Nickname',
            'show_on_minify_form' => true,
            'matchable' => true,
            'disabled' => true),
  Field.new('name' => 'name_other',
            'type' => 'text_field',
            'display_name_en' => 'Other Name',
            'matchable' => true,
            'disabled' => true),
  Field.new('name' => 'age',
            'type' => 'numeric_field',
            'display_name_en' => 'Age',
            'show_on_minify_form' => true,
            'required' => false,
            'matchable' => true,
            'disabled' => true),
  Field.new('name' => 'estimated',
            'type' => 'tick_box',
            'tick_box_label_en' => 'Yes',
            'show_on_minify_form' => true,
            'display_name_en' => 'Is the age estimated?',
            'disabled' => true),
  Field.new('name' => 'date_of_birth',
            'type' => 'date_field',
            'display_name_en' => 'Date of Birth',
            'show_on_minify_form' => true,
            'matchable' => true,
            'disabled' => true),
  Field.new('name' => 'sex',
            'type' => 'select_box',
            'show_on_minify_form' => true,
            'required' => false,
            'display_name_en' => 'Sex',
            'option_strings_source' => 'lookup lookup-gender',
            'matchable' => true,
            'disabled' => true),
  Field.new('name' => 'cpims_id',
            'type' => 'text_field',
            'display_name_en' => 'Previous Case Code',
            'help_text_en' => 'Legacy CPIMS (or other system) ID',
            'disabled' => true),
  Field.new('name' => 'national_id_no',
            'type' => 'text_field',
            'display_name_en' => 'National ID Number',
            'disabled' => true),
  Field.new('name' => 'unhcr_individual_no',
            'type' => 'text_field',
            'display_name_en' => 'UNHCR Individual ID',
            'disabled' => true),
  Field.new('name' => 'other_id_type',
            'type' => 'text_field',
            'display_name_en' => 'Type of other relevant ID document',
            'disabled' => true),
  Field.new('name' => 'other_id_no',
            'type' => 'text_field',
            'display_name_en' => 'Number of other relevant ID',
            'disabled' => true),
  Field.new('name' => 'language',
            'type' => 'select_box',
            'multi_select' => true,
            'display_name_en' => 'Languages spoken by child',
            'option_strings_source' => 'lookup lookup-language',
            'disabled' => true),
  Field.new('name' => 'disability_type_communications',
            'type' => 'text_field',
            'display_name_en' => 'Special communication needs',
            'disabled' => true),
  Field.new('name' => 'child_current_location',
            'type' => 'separator',
            'display_name_en' => "Child's Current Address",
            'disabled' => true),
  Field.new('name' => 'address_current',
            'type' => 'textarea',
            'mobile_visible' => true,
            'display_name_en' => 'Current Address',
            'help_text_en' => 'Where there is no address, please provide landmarks or description of current location',
            'disabled' => true),
  Field.new('name' => 'location_current',
            'type' => 'select_box',
            'mobile_visible' => true,
            'display_name_en' => 'Current Location',
            'option_strings_source' => 'Location',
            'disabled' => true),
  Field.new('name' => 'telephone_current',
            'type' => 'text_field',
            'display_name_en' => "Child's telephone / other contact details",
            'disabled' => true),
  Field.new('name' => 'referral_consent_header',
            'type' => 'separator',
            'display_name_en' => 'Consent and Assent'),
  Field.new('name' => 'consent_for_services',
            'type' => 'tick_box',
            'tick_box_label_en' => 'Yes',
            'display_name_en' => 'Consent has been given for the child to participate in the case management process',
            'help_text_en' => 'If consent has not been provided, do not select',
            'disabled' => true),
  Field.new('name' => 'disclosure_other_orgs',
            'type' => 'tick_box',
            'tick_box_label_en' => 'Yes',
            'display_name_en' => 'The individual providing consent agrees to share information about this case with other service providers according to the details described below.',
            'help_text' => 'This includes sharing information with other organizations providing services, this does not '\
                            'include sharing information with UNHCR.',
            'disabled' => true),
  Field.new('name' => 'unhcr_export_opt_in',
            'type' => 'tick_box',
            'display_name_en' => 'The individual providing consent agrees to share information about this case with UNHCR for the purposes of refugee protection case management.',
            'tick_box_label_en' => 'Yes',
            'editable' => false,
            'disabled' => true),
  Field.new('name' => 'referral_protection_concerns_header',
            'type' => 'separator',
            'display_name_en' => 'Protection Concerns'),
  Field.new('name' => 'protection_concerns',
            'type' => 'select_box',
            'multi_select' => true,
            'display_name_en' => 'Protection Concerns',
            'required' => false,
            'option_strings_source' => 'lookup lookup-protection-concerns',
            'disabled' => true),
  Field.new('name' => 'protection_concerns_other',
            'type' => 'text_field',
            'display_name_en' => 'If Other, please specify',
            'disabled' => true),
  Field.new('name' => 'referral_caregiver_header',
            'type' => 'separator',
            'display_name_en' => 'Primary caregiver details',
            'help_text_en' => 'Information copied from Care Arrangements subform.'),
  Field.new('name' => 'referral_caregiver_informed',
            'type' => 'radio_button',
            'display_name_en' => 'Is the caregiver informed about the referral?',
            'option_strings_source' => 'lookup lookup-yes-no'),
  Field.new('name' => 'referral_caregiver_informed_details',
            'type' => 'textarea',
            'display_name_en' => 'If no, explain why'),
  ### SUBFORM
  Field.new('name' => 'care_arrangements_section',
            'type' => 'subform',
            'editable' => true,
            'disabled' => true,
            'subform_section' => FormSection.find_by(unique_id: 'care_arrangements_section'),
            'display_name_en' => 'Care Arrangements',
            'subform_section_configuration' => {
              "fields" => %w[
                care_arrangements_type
                care_arrangement_started_date
                name_caregiver
                nickname_caregiver
                caregiver_age
                caregiver_dob
                age_estimated_caragiver
                caregiver_sex
                relationship_caregiver
                address_caregiver
                location_caregiver
                telephone_caregiver
              ],
              "display_conditions" => [
                {
                  care_arrangements_include_referral_form: true
                }
              ]
            }),
  ### SUBFORM
  Field.new('name' => 'referral_follow_up_header',
            'type' => 'separator',
            'display_name_en' => 'Contact, Feedback and Follow Up Arrangements',
            'visible' => false),
  Field.new('name' => 'referral_follow_up_contact_who',
            'type' => 'select_box',
            'display_name_en' => 'How can contact with the case be initiated and how can feedback on the service provided be given?',
            'option_strings_text_en' => [
              { id: 'contact_caseworker', display_text: 'Contact via caseworker'},
              { id: 'contact_person_referred', display_text: 'Contact the person being referred directly'}
            ].map(&:with_indifferent_access),
            'visible' => false),
  Field.new('name' => 'referral_follow_up_medium',
            'type' => 'select_box',
            "multi_select" => true,
            'display_name_en' => 'How will the caseworker follow-up on the referral?',
            'option_strings_text_en' => [
              { id: 'phone', display_text: 'Phone'},
              { id: 'email', display_text: 'Email'},
              { id: 'face_to_face', display_text: 'Face-to-face meeting (service provider)'},
              { id: 'other', display_text: 'Other'}
            ].map(&:with_indifferent_access),
            'visible' => false),
  Field.new('name' => 'referral_follow_up_medium_other',
            'type' => 'textarea',
            'display_name_en' => 'If other, please specify',
            'visible' => false),
]


FormSection.create_or_update!(
  :unique_id => 'referral_details',
  :parent_form => 'case',
  'visible' => true,
  :order_form_group => 30,
  :order => 30,
  :order_subform => 0,
  :form_group_id => 'identification_registration',
  :fields => referral_details_fields,
  'editable' => false,
  'name_en' => 'Referral Details',
  'description_en' => 'Referral Details form'
)
